(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-097bc4cb"],{"2d45":function(e,t,o){},"35f1":function(e,t,o){"use strict";o.r(t);var a=o("7dbf").a,o=(o("c60dd"),o("2877")),o=Object(o.a)(a,function(){var o=this,a=o._self._c;return a("div",[a("Card",[a("div",{staticClass:"mb_10"},[a("Button",{attrs:{icon:"md-add"},on:{click:o.addParent}},[o._v("添加一级分类")])],1),a("Table",{staticClass:"table",attrs:{"load-data":o.handleLoadData,"row-key":"id",loading:o.loading,data:o.tableData,columns:o.columns},scopedSlots:o._u([{key:"action",fn:function(t){return[a("Dropdown",{directives:[{name:"show",rawName:"v-show",value:2==t.row.level,expression:"scope.row.level == 2"}],attrs:{trigger:"click"}},[a("Button",{attrs:{size:"small"}},[o._v(" 绑定 "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{nativeOn:{click:function(e){return o.brandOperation(t.row)}}},[o._v("编辑绑定品牌")]),a("DropdownItem",{nativeOn:{click:function(e){return o.specOperation(t.row)}}},[o._v("编辑绑定规格")]),a("DropdownItem",{nativeOn:{click:function(e){return o.parameterOperation(t.row)}}},[o._v("编辑绑定参数")])],1)],1),o._v("   "),a("Dropdown",{attrs:{trigger:"click"}},[a("Button",{attrs:{size:"small"}},[o._v(" 操作 "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{nativeOn:{click:function(e){return o.edit(t.row)}}},[o._v("编辑")]),1==t.row.deleteFlag?a("DropdownItem",{nativeOn:{click:function(e){return o.enable(t.row)}}},[o._v("启用")]):o._e(),0==t.row.deleteFlag?a("DropdownItem",{nativeOn:{click:function(e){return o.disable(t.row)}}},[o._v("禁用")]):o._e(),a("DropdownItem",{nativeOn:{click:function(e){return o.remove(t.row)}}},[o._v("删除")])],1)],1),o._v("   "),a("Button",{directives:[{name:"show",rawName:"v-show",value:2!=t.row.level,expression:"scope.row.level != 2"}],staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small",icon:"md-add"},on:{click:function(e){return o.addChildren(t.row)}}},[o._v("添加子分类 ")])]}},{key:"commissionRate",fn:function(e){return[o._v(" "+o._s(e.row.commissionRate)+"% ")]}},{key:"deleteFlag",fn:function(e){e=e.row;return[a("Tag",{class:{ml_10:e.deleteFlag},attrs:{color:0==e.deleteFlag?"success":"error"}},[o._v(" "+o._s(0==e.deleteFlag?"正常启用":"禁用"))])]}}])}),a("Modal",{attrs:{title:o.modalTitle,"mask-closable":!1,width:500},model:{value:o.modalVisible,callback:function(e){o.modalVisible=e},expression:"modalVisible"}},[a("Form",{ref:"form",attrs:{model:o.formAdd,"label-width":100,rules:o.formValidate}},[o.showParent?a("div",[a("FormItem",{attrs:{label:"上级分类",prop:"parentId"}},[o._v(" "+o._s(o.parentTitle)+" "),a("Input",{staticStyle:{width:"100%",display:"none"},attrs:{clearable:""},model:{value:o.formAdd.parentId,callback:function(e){o.$set(o.formAdd,"parentId",e)},expression:"formAdd.parentId"}})],1)],1):o._e(),a("FormItem",{staticStyle:{display:"none"},attrs:{label:"层级",prop:"level"}},[a("Input",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:o.formAdd.level,callback:function(e){o.$set(o.formAdd,"level",e)},expression:"formAdd.level"}})],1),a("FormItem",{attrs:{label:"分类名称",prop:"name"}},[a("Input",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:o.formAdd.name,callback:function(e){o.$set(o.formAdd,"name",e)},expression:"formAdd.name"}})],1),1!==o.formAdd.level?a("FormItem",{attrs:{label:"分类图标",prop:"image"}},[a("upload-pic-input",{staticStyle:{width:"100%"},model:{value:o.formAdd.image,callback:function(e){o.$set(o.formAdd,"image",e)},expression:"formAdd.image"}})],1):o._e(),a("FormItem",{staticStyle:{width:"345px"},attrs:{label:"排序值",prop:"sortOrder"}},[a("InputNumber",{model:{value:o.formAdd.sortOrder,callback:function(e){o.$set(o.formAdd,"sortOrder",e)},expression:"formAdd.sortOrder"}})],1),a("FormItem",{staticStyle:{width:"345px"},attrs:{label:"佣金比例(%)",prop:"commissionRate"}},[a("InputNumber",{model:{value:o.formAdd.commissionRate,callback:function(e){o.$set(o.formAdd,"commissionRate",e)},expression:"formAdd.commissionRate"}})],1),a("FormItem",{attrs:{label:"是否启用",prop:"deleteFlag"}},[a("i-switch",{attrs:{size:"large","true-value":0,"false-value":1},model:{value:o.formAdd.deleteFlag,callback:function(e){o.$set(o.formAdd,"deleteFlag",e)},expression:"formAdd.deleteFlag"}},[a("span",{attrs:{slot:"open"},slot:"open"},[o._v("启用")]),a("span",{attrs:{slot:"close"},slot:"close"},[o._v("禁用")])])],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(e){o.modalVisible=!1}}},[o._v("取消")]),a("Button",{attrs:{type:"primary",loading:o.submitLoading},on:{click:o.Submit}},[o._v("提交")])],1)],1),a("Modal",{attrs:{title:o.modalBrandTitle,"mask-closable":!1,width:500},model:{value:o.modalBrandVisible,callback:function(e){o.modalBrandVisible=e},expression:"modalBrandVisible"}},[a("Form",{ref:"brandForm",attrs:{model:o.brandForm,"label-width":100}},[a("Select",{attrs:{filterable:"",multiple:""},model:{value:o.brandForm.categoryBrands,callback:function(e){o.$set(o.brandForm,"categoryBrands",e)},expression:"brandForm.categoryBrands"}},o._l(o.brandWay,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[o._v(o._s(e.name))])}),1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(e){o.modalBrandVisible=!1}}},[o._v("取消")]),a("Button",{attrs:{type:"primary",loading:o.submitLoading},on:{click:o.saveCategoryBrand}},[o._v("提交")])],1)],1),a("Modal",{attrs:{title:o.modalSpecTitle,"mask-closable":!1,width:500},model:{value:o.modalSpecVisible,callback:function(e){o.modalSpecVisible=e},expression:"modalSpecVisible"}},[a("Form",{ref:"specForm",attrs:{model:o.specForm,"label-width":100}},[a("Select",{attrs:{multiple:""},model:{value:o.specForm.categorySpecs,callback:function(e){o.$set(o.specForm,"categorySpecs",e)},expression:"specForm.categorySpecs"}},o._l(o.specifications,function(e){return a("Option",{key:e.id,attrs:{value:e.id,label:e.specName}})}),1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(e){o.modalSpecVisible=!1}}},[o._v("取消")]),a("Button",{attrs:{type:"primary",loading:o.submitLoading},on:{click:o.saveCategorySpec}},[o._v("提交")])],1)],1)],1)],1)},[],!1,null,"219b6156",null);t.default=o.exports},"7dbf":function(module,__webpack_exports__,__webpack_require__){"use strict";var _api_goods__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("c40e"),_components_lili_upload_pic_input__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("da7e"),_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("ed08");__webpack_exports__.a={name:"goods-category",components:{uploadPicInput:_components_lili_upload_pic_input__WEBPACK_IMPORTED_MODULE_1__.a},data:function(){return{submitLoading:!1,categoryList:[],loading:!1,brands:[],specifications:[],categoryId:"",categorySpecs:[],modalType:0,modalVisible:!1,modalBrandVisible:!1,modalSpecVisible:!1,modalTitle:"",showParent:!1,parentTitle:"",modalBrandTitle:"",modalSpecTitle:"",formAdd:{parentId:"",name:"",image:"",sortOrder:0,deleteFlag:0,commissionRate:0,level:0},brandForm:{categoryBrands:[]},brandWay:"",specForm:{},formValidate:{commissionRate:[_utils__WEBPACK_IMPORTED_MODULE_2__.a.REQUIRED,_utils__WEBPACK_IMPORTED_MODULE_2__.a.INTEGER],name:[_utils__WEBPACK_IMPORTED_MODULE_2__.a.REQUIRED,_utils__WEBPACK_IMPORTED_MODULE_2__.a.VARCHAR20],sortOrder:[_utils__WEBPACK_IMPORTED_MODULE_2__.a.REQUIRED,_utils__WEBPACK_IMPORTED_MODULE_2__.a.INTEGER]},columns:[{title:"分类名称",key:"name",tree:!0},{title:"状态",slot:"deleteFlag"},{title:"佣金",key:"commissionRate",slot:"commissionRate"},{title:"操作",key:"action",slot:"action"}],tableData:[],categoryIndex:0,checkedCategoryChildren:""}},methods:{init:function(){this.getAllList(0),this.getBrandList(),this.getSpecList()},getBrandList:function(){var t=this;Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.k)().then(function(e){t.brandWay=e})},getSpecList:function(){var t=this;Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.w)().then(function(e){0!=e.length&&(t.specifications=e)})},brandOperation:function(t){var o=this;Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.l)(t.id).then(function(e){o.categoryId=t.id,o.modalBrandTitle="品牌关联",o.brandForm.categoryBrands=e.result.map(function(e){return e.id}),o.modalBrandVisible=!0})},specOperation:function(t){var o=this;Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.n)(t.id).then(function(e){o.categoryId=t.id,o.modalSpecTitle="规格关联",o.specForm.categorySpecs=e.map(function(e){return e.id}),o.modalSpecVisible=!0})},saveCategorySpec:function(){var t=this;Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.E)(this.categoryId,this.specForm).then(function(e){t.submitLoading=!1,e.success&&(t.$Message.success("操作成功"),t.modalSpecVisible=!1)})},saveCategoryBrand:function(){var t=this;Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.D)(this.categoryId,this.brandForm).then(function(e){t.submitLoading=!1,e.success&&(t.$Message.success("操作成功"),t.modalBrandVisible=!1)})},parameterOperation:function(e){this.$router.push({name:"parameter",query:{id:e.id}})},addChildren:function addChildren(v){this.modalType=0,this.modalTitle="添加子分类",this.parentTitle=v.name,this.formAdd.level=eval(v.level+"+1"),this.formAdd.commissionRate=v.commissionRate,this.showParent=!0,delete this.formAdd.id,this.formAdd.parentId=v.id,this.modalVisible=!0},edit:function(e){this.modalType=1,this.modalTitle="编辑",this.formAdd.id=e.id,this.formAdd.name=e.name,this.formAdd.level=e.level,this.formAdd.parentId=e.parentId,this.formAdd.sortOrder=e.sortOrder,this.formAdd.commissionRate=e.commissionRate,this.formAdd.deleteFlag=e.deleteFlag,this.formAdd.image=e.image,this.showParent=!1,this.modalVisible=!0},addParent:function(){this.modalType=0,this.modalTitle="添加一级分类",this.parentTitle="顶级分类",this.showParent=!0,this.$refs.form.resetFields(),delete this.formAdd.id,this.formAdd.parentId=0,this.modalVisible=!0},Submit:function(){var t=this;this.$refs.form.validate(function(e){e&&(t.submitLoading=!0,0===t.modalType?(delete t.formAdd.id,Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.y)(t.formAdd).then(function(e){t.submitLoading=!1,e.success&&(t.$Message.success("添加成功"),t.getAllList(t.categoryIndex),t.modalVisible=!1,t.$refs.form.resetFields())})):Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.J)(t.formAdd).then(function(e){t.submitLoading=!1,e.success&&(t.$Message.success("修改成功"),t.getAllList(t.categoryIndex),t.modalVisible=!1,t.$refs.form.resetFields())}))})},remove:function(e){var t=this;this.$Modal.confirm({title:"确认删除",content:"您确认要删除 "+e.name+" ?",loading:!0,onOk:function(){Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.d)(e.id).then(function(e){t.$Modal.remove(),e.success&&(t.$Message.success("操作成功"),t.getAllList(0))})}})},handleLoadData:function(t,o){var e=this;0==t.level?JSON.parse(JSON.stringify(this.categoryList)).forEach(function(e){e.id==t.id&&(e.children.map(function(e){e._loading=!1,e.children=[]}),setTimeout(function(){o(e.children)},1e3))}):(this.deepCategoryChildren(t.id,this.categoryList),setTimeout(function(){o(e.checkedCategoryChildren)},1e3))},deepCategoryChildren:function(e,t){if("0"!=e&&0!=t.length)for(var o=0;o<t.length;o++){var a=t[o];if(a.id==e)return void(this.checkedCategoryChildren=a.children);this.deepCategoryChildren(e,a.children)}},getAllList:function(e){var t=this;this.loading=!0,Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.o)(e).then(function(e){t.loading=!1,e.success&&(localStorage.setItem("category",JSON.stringify(e.result)),t.categoryList=JSON.parse(JSON.stringify(e.result)),t.tableData=e.result.map(function(e){return 0!=e.children.length&&(e.children=[],e._loading=!1),e}))})},enable:function(e){var t=this;this.$Modal.confirm({title:"确认启用",content:"您是否要启用当前分类 "+e.name+" 及其子分类?",loading:!0,okText:"是",cancelText:"否",onOk:function(){Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.i)(e.id,{enableOperations:0}).then(function(e){t.$Modal.remove(),e.success&&(t.$Message.success("操作成功"),t.getAllList(0))})},onCancel:function(){t.getAllList(0)}})},disable:function(e){var t=this;this.$Modal.confirm({title:"确认禁用",content:"您是否要禁用当前分类 "+e.name+" 及其子分类?",loading:!0,okText:"是",cancelText:"否",onOk:function(){Object(_api_goods__WEBPACK_IMPORTED_MODULE_0__.i)(e.id,{enableOperations:!0}).then(function(e){t.$Modal.remove(),e.success&&(t.$Message.success("操作成功"),t.getAllList(0))})},onCancel:function(){t.getAllList(0)}})}},mounted:function(){this.init()}}},b149:function(e,t,o){"use strict";o("2d45")},c60dd:function(e,t,o){"use strict";o("d2f0")},d2f0:function(e,t,o){},da7e:function(e,t,o){"use strict";var a=o("365c"),i={name:"uploadPicInput",props:{value:String,size:{default:"default",type:String},placeholder:{type:String,default:"图片链接"},showInput:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},maxlength:Number,icon:{type:String,default:"ios-cloud-upload-outline"}},data:function(){return{accessToken:{},currentValue:this.value,loading:!1,viewImage:!1,uploadFileUrl:a.nb}},methods:{init:function(){this.accessToken={accessToken:this.getStore("accessToken")}},handleFormatError:function(e){this.loading=!1,this.$Notice.warning({title:"不支持的文件格式",desc:"所选文件‘ "+e.name+" ’格式不正确, 请选择 .jpg .jpeg .png .gif .bmp格式文件"})},handleMaxSize:function(e){this.loading=!1,this.$Notice.warning({title:"文件大小过大",desc:"所选文件大小过大, 不得超过1M."})},beforeUpload:function(){return this.loading=!0},handleSuccess:function(e,t){this.loading=!1,e.success&&(this.currentValue=e.result,this.$emit("input",this.currentValue),this.$emit("on-change",this.currentValue))},handleError:function(e,t,o){this.loading=!1,this.$Message.error(e.toString())},handleChange:function(e){this.$emit("input",this.currentValue),this.$emit("on-change",this.currentValue),this.$attrs.rollback&&this.$attrs.rollback()},setCurrentValue:function(e){e!==this.currentValue&&(this.currentValue=e,this.$emit("on-change",this.currentValue))}},watch:{value:function(e){this.setCurrentValue(e)}},created:function(){this.init()}},o=(o("b149"),o("2877")),o=Object(o.a)(i,function(){var t=this,e=t._self._c;return e("div",[e("div",{staticStyle:{display:"flex"}},[e("Input",{directives:[{name:"show",rawName:"v-show",value:t.showInput,expression:"showInput"}],attrs:{placeholder:t.placeholder,size:t.size,disabled:t.disabled,readonly:t.readonly,maxlength:t.maxlength},on:{"on-change":t.handleChange},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}},[e("Poptip",{attrs:{slot:"append",transfer:"",trigger:"hover",title:"图片预览",placement:"right"},slot:"append"},[e("Icon",{staticClass:"see-icon",attrs:{type:"md-eye"}}),e("div",{attrs:{slot:"content"},slot:"content"},[e("img",{staticStyle:{width:"100%",margin:"0 auto",display:"block"},attrs:{src:t.currentValue,alt:"该资源不存在"}}),e("a",{staticStyle:{"margin-top":"5px","text-align":"right",display:"block"},on:{click:function(e){t.viewImage=!0}}},[t._v("查看大图")])])],1)],1),e("Upload",{ref:"up",staticClass:"upload",attrs:{action:t.uploadFileUrl,headers:t.accessToken,"on-success":t.handleSuccess,"on-error":t.handleError,format:["jpg","jpeg","png","gif","bmp"],accept:".jpg, .jpeg, .png, .gif, .bmp","max-size":1024,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"before-upload":t.beforeUpload,"show-upload-list":!1}},[e("Button",{attrs:{loading:t.loading,size:t.size,disabled:t.disabled}},[t._v("上传图片")])],1)],1),e("Modal",{attrs:{title:"图片预览",styles:{top:"30px"},draggable:""},model:{value:t.viewImage,callback:function(e){t.viewImage=e},expression:"viewImage"}},[e("img",{staticStyle:{width:"100%",margin:"0 auto",display:"block"},attrs:{src:t.currentValue,alt:"该资源不存在"}}),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{on:{click:function(e){t.viewImage=!1}}},[t._v("关闭")])],1)])],1)},[],!1,null,"75ceb5cf",null);t.a=o.exports},ed08:function(e,t,o){"use strict";o.d(t,"a",function(){return a});var a={},i=(o.r(a),o.d(a,"qq",function(){return i}),o.d(a,"name",function(){return n}),o.d(a,"mobile",function(){return r}),o.d(a,"email",function(){return s}),o.d(a,"password",function(){return l}),o.d(a,"integer",function(){return d}),o.d(a,"Integer",function(){return c}),o.d(a,"discount",function(){return u}),o.d(a,"rate",function(){return m}),o.d(a,"money",function(){return _}),o.d(a,"IDCard",function(){return p}),o.d(a,"userName",function(){return f}),o.d(a,"URL",function(){return g}),o.d(a,"TEL",function(){return h}),o.d(a,"INTEGER",function(){return b}),o.d(a,"NUMBER",function(){return v}),o.d(a,"VARCHAR5",function(){return y}),o.d(a,"VARCHAR20",function(){return w}),o.d(a,"VARCHAR255",function(){return O}),o.d(a,"URL200",function(){return A}),o.d(a,"REQUIRED",function(){return E}),/^[1-9][0-9]{4,14}$/),n=/^[\u4e00-\u9fa5]{0,}$/,r=/^0?(13[0-9]|14[0-9]|15[0-9]|16[0-9]|17[0-9]|18[0-9]|19[0-9])[0-9]{8}$/,s=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,l=/^[@A-Za-z0-9!#$%^&*.~,]{6,20}$/,d=/^[1-9]\d*$/,c=/^[0-9]\d*$/,u=/^((0\.[1-9]{1})|(([1-9]{1})(\.\d{1})?))$/,m=/^([0-9]{1,2}|100)$/,_=/(^[1-9]([0-9]+)?(\.[0-9]{1,2})?$)|(^(0){1}$)|(^[0-9]\.[0-9]([0-9])?$)/,p=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,f=/[A-Za-z0-9_\-\u4e00-\u9fa5]$/,g=/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/,h=/0\d{2,3}-\d{7,8}/,b={pattern:/^[0-9]\d{0,10}|0$/,message:"请输入正整数"},v={pattern:/^(\-|\+)?\d{0,10}$/,message:"请输入数字"},y={pattern:/^.{1,5}$/,message:"长度应该限制在1-5个字符"},w={pattern:/^.{1,20}$/,message:"长度应该限制在1-20个字符"},O={pattern:/^.{1,255}$/,message:"超出最大长度限制"},A={pattern:/[a-zA-z]+\:\/\/[^\s]{1,190}/,message:"请输入长度不超过200的URL地址"},E={required:!0,message:"请填写参数"}}}]);