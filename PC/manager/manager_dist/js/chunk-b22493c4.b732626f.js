(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-b22493c4"],{"0285":function(t,e,r){},"79b0":function(t,e,r){"use strict";r.r(e);var o=r("f74c"),n=r("ed08");function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,r){e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}function x(){x=function(){return s};var s={},t=Object.prototype,c=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",n=e.toStringTag||"@@toStringTag";function i(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{i({},"")}catch(t){i=function(t,e,r){return t[e]=r}}function a(t,e,r,o){var n,i,s,a,e=e&&e.prototype instanceof l?e:l,e=Object.create(e.prototype),o=new b(o||[]);return e._invoke=(n=t,i=r,s=o,a="suspendedStart",function(t,e){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===t)throw e;return k()}for(s.method=t,s.arg=e;;){var r=s.delegate;if(r){r=function t(e,r){var o=e.iterator[r.method];if(void 0===o){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=void 0,t(e,r),"throw"===r.method))return f;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}o=u(o,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,f;o=o.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,s);if(r){if(r===f)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===a)throw a="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a="executing";r=u(n,i,s);if("normal"===r.type){if(a=s.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:s.done}}"throw"===r.type&&(a="completed",s.method="throw",s.arg=r.arg)}}),e}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}s.wrap=a;var f={};function l(){}function d(){}function h(){}var e={},m=(i(e,o,function(){return this}),Object.getPrototypeOf),m=m&&m(m(L([]))),p=(m&&m!==t&&c.call(m,o)&&(e=m),h.prototype=l.prototype=Object.create(e));function g(t){["next","throw","return"].forEach(function(e){i(t,e,function(t){return this._invoke(e,t)})})}function y(s,a){var e;this._invoke=function(r,o){function t(){return new a(function(t,e){!function e(t,r,o,n){var i,t=u(s[t],s,r);if("throw"!==t.type)return(r=(i=t.arg).value)&&"object"==$(r)&&c.call(r,"__await")?a.resolve(r.__await).then(function(t){e("next",t,o,n)},function(t){e("throw",t,o,n)}):a.resolve(r).then(function(t){i.value=t,o(i)},function(t){return e("throw",t,o,n)});n(t.arg)}(r,o,t,e)})}return e=e?e.then(t,t):t()}}function v(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function b(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(v,this),this.reset(!0)}function L(e){if(e){var r,t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(t=function t(){for(;++r<e.length;)if(c.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:k}}function k(){return{value:void 0,done:!0}}return i(p,"constructor",d.prototype=h),i(h,"constructor",d),d.displayName=i(h,n,"GeneratorFunction"),s.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},s.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,i(t,n,"GeneratorFunction")),t.prototype=Object.create(p),t},s.awrap=function(t){return{__await:t}},g(y.prototype),i(y.prototype,r,function(){return this}),s.AsyncIterator=y,s.async=function(t,e,r,o,n){void 0===n&&(n=Promise);var i=new y(a(t,e,r,o),n);return s.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},g(p),i(p,n,"Generator"),i(p,o,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),s.keys=function(r){var t,o=[];for(t in r)o.push(t);return o.reverse(),function t(){for(;o.length;){var e=o.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},s.values=L,b.prototype={constructor:b,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&c.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var o=this;function t(t,e){return i.type="throw",i.arg=r,o.next=t,e&&(o.method="next",o.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e],i=n.completion;if("root"===n.tryLoc)return t("end");if(n.tryLoc<=this.prev){var s=c.call(n,"catchLoc"),a=c.call(n,"finallyLoc");if(s&&a){if(this.prev<n.catchLoc)return t(n.catchLoc,!0);if(this.prev<n.finallyLoc)return t(n.finallyLoc)}else if(s){if(this.prev<n.catchLoc)return t(n.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return t(n.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&c.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}var i=(n=n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc?null:n)?n.completion:{};return i.type=t,i.arg=e,n?(this.method="next",this.next=n.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),w(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,o,n=this.tryEntries[e];if(n.tryLoc===t)return"throw"===(r=n.completion).type&&(o=r.arg,w(n)),o}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:L(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},s}function c(t,e,r,o,n,i,s){try{var a=t[i](s),c=a.value}catch(t){return r(t)}a.done?e(c):Promise.resolve(c).then(o,n)}var s={name:"add-kanjia-activity-goods",components:{skuSelect:r("f415").a},watch:{},data:function(){var r=this;return{modalType:0,form:{promotionGoodsList:[]},id:this.$route.query.id,submitLoading:!1,selectedGoods:[],promotionGoodsList:[],formRule:{rangeTime:[{required:!0,message:"请选择活动时间"}]},columns:[{type:"selection",width:60,align:"center"},{title:"商品名称",key:"goodsName",tooltip:!0,minWidth:100},{title:"商品价格",key:"price",width:120,render:function(t,e){return t("div",r.$options.filters.unitPrice(e.row.price,"￥"))}},{title:"库存",key:"quantity",width:100},{title:"结算价格",slot:"settlementPrice",width:110},{title:"最低砍",slot:"lowestPrice",width:110},{title:"最高砍",slot:"highestPrice",width:110},{title:"活动库存",slot:"stock",width:110},{title:"操作",key:"action",align:"center",width:100,render:function(t,e){return t("Button",{props:{size:"small",type:"error",ghost:!0},on:{click:function(){r.delGoods(e.index)}}},"删除")}}],options:{disabledDate:function(t){return t&&t.valueOf()<Date.now()-864e5}}}},mounted:function(){var a,e=this;return a=x().mark(function t(){return x().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.id&&(e.getCoupon(),e.modalType=1);case 1:case"end":return t.stop()}},t)}),function(){var t=this,s=arguments;return new Promise(function(e,r){var o=a.apply(t,s);function n(t){c(o,e,r,n,i,"next",t)}function i(t){c(o,e,r,n,i,"throw",t)}n(void 0)})}()},methods:(i(s={openSkuList:function(){this.$refs.skuSelect.open("goods");var t=JSON.parse(JSON.stringify(this.promotionGoodsList));t.forEach(function(t){t.id=t.skuId}),this.$refs.skuSelect.goodsData=t},handleSubmit:function(){var r=this;this.$refs.form.validate(function(t){var e;t&&(t=JSON.parse(JSON.stringify(r.form)),""===r.form.rangeTime[0]||""===r.form.rangeTime[0]?r.$Message.error("请选择活动时间"):(t.startTime=r.$options.filters.unixToDate(r.form.rangeTime[0]/1e3),t.endTime=r.$options.filters.unixToDate(r.form.rangeTime[1]/1e3),delete t.rangeTime,e=!0,0<r.form.promotionGoodsList.length&&r.form.promotionGoodsList.forEach(function(t){return t.stock<=0||t.stock>t.quantity?(e=!1,void r.$Message.error("活动库存不能为0且不能超过商品库存")):n.a.money.test(t.settlementPrice)?t.settlementPrice<0||t.settlementPrice>t.price?(e=!1,void r.$Message.error("结算价格金额不能为0且不能超过商品价格")):n.a.money.test(t.highestPrice)?t.highestPrice<=0||t.highestPrice>t.price?(e=!1,void r.$Message.error("最高可砍金额不能为0且不能超过商品价格")):n.a.money.test(t.lowestPrice)?t.lowestPrice<=0||t.lowestPrice>t.price?(e=!1,void r.$Message.error("最低可砍金额不能为0")):parseInt(t.lowestPrice)>parseInt(t.highestPrice)?(e=!1,void r.$Message.error("最低砍价金额不能大于最高砍价金额")):void 0:(e=!1,void r.$Message.error("最低可砍金额格式错误")):(e=!1,void r.$Message.error("最高可砍金额格式错误")):(e=!1,void r.$Message.error("结算价格金额格式不正确"))}),e&&(r.submitLoading=!0,Object(o.F)(t).then(function(t){r.submitLoading=!1,t.success&&(r.$Message.success("砍价活动修改成功"),r.closeCurrentPage())}))))})},closeCurrentPage:function(){this.$store.commit("removeTag","add-kan-jia-goods"),localStorage.pageOpenedList=JSON.stringify(this.$store.state.app.pageOpenedList),this.$router.go(-1)}},"openSkuList",function(){this.$refs.skuSelect.open("goods");var t=JSON.parse(JSON.stringify(this.form.promotionGoodsList));t.forEach(function(t){t.id=t.skuId}),this.$refs.skuSelect.goodsData=t}),i(s,"changeSelect",function(t){this.selectedGoods=t}),i(s,"delGoods",function(t){this.form.promotionGoodsList.splice(t,1)}),i(s,"selectedGoodsData",function(t){var e=[];t.forEach(function(t){e.push({settlementPrice:t.settlementPrice||0,purchasePrice:0,lowestPrice:t.lowestPrice||0,highestPrice:t.highestPrice||0,stock:t.stock||0,goodsName:t.goodsName,price:t.price,originalPrice:t.price,quantity:t.quantity,storeId:t.storeId,storeName:t.storeName,skuId:t.id})}),this.form.promotionGoodsList=e}),s)},r=(r("fd68"),r("2877")),r=Object(r.a)(s,function(){var r=this,o=r._self._c;return o("div",[o("Card",[o("Form",{ref:"form",attrs:{model:r.form,"label-width":120,rules:r.formRule}},[o("div",{staticClass:"base-info-item"},[o("div",{staticClass:"form-item-view"},[o("h4",[r._v("商品信息")]),o("FormItem",{attrs:{label:"选择商品",prop:"scopeType"}},[o("Button",{attrs:{type:"primary"},on:{click:r.openSkuList}},[r._v("选择商品")])],1),o("FormItem",{attrs:{astyle:"width: 100%"}},[o("Table",{attrs:{border:"",columns:r.columns,data:r.form.promotionGoodsList},on:{"on-selection-change":r.changeSelect},scopedSlots:r._u([{key:"skuId",fn:function(t){t=t.row;return[o("div",[r._v(r._s(t.skuId))])]}},{key:"settlementPrice",fn:function(t){var e=t.index;return[o("InputNumber",{attrs:{min:0},model:{value:r.form.promotionGoodsList[e].settlementPrice,callback:function(t){r.$set(r.form.promotionGoodsList[e],"settlementPrice",t)},expression:"form.promotionGoodsList[index].settlementPrice"}})]}},{key:"lowestPrice",fn:function(t){var e=t.index;return[o("InputNumber",{attrs:{min:0},model:{value:r.form.promotionGoodsList[e].lowestPrice,callback:function(t){r.$set(r.form.promotionGoodsList[e],"lowestPrice",t)},expression:"form.promotionGoodsList[index].lowestPrice"}})]}},{key:"highestPrice",fn:function(t){var e=t.index;return[o("InputNumber",{attrs:{min:0},model:{value:r.form.promotionGoodsList[e].highestPrice,callback:function(t){r.$set(r.form.promotionGoodsList[e],"highestPrice",t)},expression:"form.promotionGoodsList[index].highestPrice"}})]}},{key:"stock",fn:function(t){var e=t.index;return[o("InputNumber",{attrs:{min:0},model:{value:r.form.promotionGoodsList[e].stock,callback:function(t){r.$set(r.form.promotionGoodsList[e],"stock",t)},expression:"form.promotionGoodsList[index].stock"}})]}}])})],1),o("FormItem",{attrs:{label:"活动时间",prop:"rangeTime"}},[o("DatePicker",{staticStyle:{width:"260px"},attrs:{type:"datetimerange",format:"yyyy-MM-dd HH:mm:ss",placeholder:"请选择",options:r.options},model:{value:r.form.rangeTime,callback:function(t){r.$set(r.form,"rangeTime",t)},expression:"form.rangeTime"}})],1),o("div",[o("Button",{attrs:{type:"text"},on:{click:r.closeCurrentPage}},[r._v("返回")]),o("Button",{attrs:{type:"primary",loading:r.submitLoading},on:{click:r.handleSubmit}},[r._v("提交")])],1)],1)])])],1),o("sku-select",{ref:"skuSelect",on:{selectedGoodsData:r.selectedGoodsData}})],1)},[],!1,null,null,null);e.default=r.exports},ed08:function(t,e,r){"use strict";r.d(e,"a",function(){return o});var o={},n=(r.r(o),r.d(o,"qq",function(){return n}),r.d(o,"name",function(){return i}),r.d(o,"mobile",function(){return s}),r.d(o,"email",function(){return a}),r.d(o,"password",function(){return c}),r.d(o,"integer",function(){return u}),r.d(o,"Integer",function(){return f}),r.d(o,"discount",function(){return l}),r.d(o,"rate",function(){return d}),r.d(o,"money",function(){return h}),r.d(o,"IDCard",function(){return m}),r.d(o,"userName",function(){return p}),r.d(o,"URL",function(){return g}),r.d(o,"TEL",function(){return y}),r.d(o,"INTEGER",function(){return v}),r.d(o,"NUMBER",function(){return w}),r.d(o,"VARCHAR5",function(){return b}),r.d(o,"VARCHAR20",function(){return L}),r.d(o,"VARCHAR255",function(){return k}),r.d(o,"URL200",function(){return $}),r.d(o,"REQUIRED",function(){return x}),/^[1-9][0-9]{4,14}$/),i=/^[\u4e00-\u9fa5]{0,}$/,s=/^0?(13[0-9]|14[0-9]|15[0-9]|16[0-9]|17[0-9]|18[0-9]|19[0-9])[0-9]{8}$/,a=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,c=/^[@A-Za-z0-9!#$%^&*.~,]{6,20}$/,u=/^[1-9]\d*$/,f=/^[0-9]\d*$/,l=/^((0\.[1-9]{1})|(([1-9]{1})(\.\d{1})?))$/,d=/^([0-9]{1,2}|100)$/,h=/(^[1-9]([0-9]+)?(\.[0-9]{1,2})?$)|(^(0){1}$)|(^[0-9]\.[0-9]([0-9])?$)/,m=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,p=/[A-Za-z0-9_\-\u4e00-\u9fa5]$/,g=/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/,y=/0\d{2,3}-\d{7,8}/,v={pattern:/^[0-9]\d{0,10}|0$/,message:"请输入正整数"},w={pattern:/^(\-|\+)?\d{0,10}$/,message:"请输入数字"},b={pattern:/^.{1,5}$/,message:"长度应该限制在1-5个字符"},L={pattern:/^.{1,20}$/,message:"长度应该限制在1-20个字符"},k={pattern:/^.{1,255}$/,message:"超出最大长度限制"},$={pattern:/[a-zA-z]+\:\/\/[^\s]{1,190}/,message:"请输入长度不超过200的URL地址"},x={required:!0,message:"请填写参数"}},fd68:function(t,e,r){"use strict";r("0285")}}]);