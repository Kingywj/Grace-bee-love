(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7aa9ecac"],{"3a08":function(e,t,r){"use strict";r.r(t);var o=r("365c"),s=r("c276");r("be65");var i={name:"menu-manage",data:function(){return{loading:!0,strict:!0,maxHeight:"500px",expandLevel:1,menuModalVisible:!1,selectList:[],selectCount:0,showParent:!1,searchKey:"",parentTitle:"",editTitle:"",modalTitle:"",form:{id:"",title:"",name:"",path:"",frontRoute:"",parentId:"",sortOrder:0,level:0,permission:""},formAdd:{},formValidate:{title:[{required:!0,message:"菜单名称名称不能为空",trigger:"blur"}],name:[{required:!0,message:"路由名称不能为空",trigger:"blur"}],path:[{required:!0,message:"路由地址不能为空",trigger:"blur"}],frontRoute:[{required:!0,message:"文件地址不能为空",trigger:"blur"}],sortOrder:[{required:!0,type:"number",message:"排序值不能为空",trigger:"blur"}]},submitLoading:!1,data:[]}},methods:{init:function(){this.getAllList()},renderContent:function(e,t){t.root,t.node;var t=t.data,r="";return 0==t.level?r="ios-navigate":1==t.level?r="md-list-box":2==t.level&&(r="md-list"),e("span",[e("span",[e("Icon",{props:{type:r,size:"16"},style:{"margin-right":"8px","margin-bottom":"3px"}}),e("span",t.title)])])},handleDropdown:function(e){"expandOne"==e?(this.expandLevel=1,this.getAllList()):"expandTwo"==e?(this.expandLevel=2,this.getAllList()):"expandThree"==e&&(this.expandLevel=3,this.getAllList()),"expandAll"==e?(this.expandLevel=4,this.getAllList()):"refresh"==e&&this.getAllList()},getAllList:function(){var r=this;this.loading=!0,Object(o.y)().then(function(e){var t;r.loading=!1,e.success&&(t=r.expandLevel,e.result.forEach(function(e){1==t?(0==e.level&&(e.expand=!1),e.children&&0<e.children.length&&e.children.forEach(function(e){1==e.level&&(e.expand=!1),e.children&&0<e.children.length&&e.children.forEach(function(e){2==e.level&&(e.expand=!1)})})):2==t?(0==e.level&&(e.expand=!0),e.children&&0<e.children.length&&e.children.forEach(function(e){1==e.level&&(e.expand=!1),e.children&&0<e.children.length&&e.children.forEach(function(e){2==e.level&&(e.expand=!1)})})):3==t?(0==e.level&&(e.expand=!0),e.children&&0<e.children.length&&e.children.forEach(function(e){1==e.level&&(e.expand=!0),e.children&&0<e.children.length&&e.children.forEach(function(e){2==e.level&&(e.expand=!1)})})):4==t&&(0==e.level&&(e.expand=!0),e.children&&0<e.children.length&&e.children.forEach(function(e){1==e.level&&(e.expand=!0),e.children&&0<e.children.length&&e.children.forEach(function(e){2==e.level&&(e.expand=!0)})}))}),r.data=e.result)})},selectTree:function(e){0<e.length?(e=JSON.stringify(e),e=JSON.parse(e),this.form=e[0],this.editTitle=e[0].title):this.cancelEdit()},search:function(){var t=this;this.searchKey?(this.loading=!0,Object(o.eb)({title:this.searchKey}).then(function(e){t.loading=!1,e.success&&(t.data=e.result)})):this.getAllList()},cancelEdit:function(){var e=this.$refs.tree.getSelectedNodes()[0];e&&(e.selected=!1),this.$refs.form.resetFields(),this.form.id="",this.editTitle=""},handleReset:function(){this.$refs.form.resetFields(),this.form.frontRoute=""},submitEdit:function(){var t=this;this.$refs.form.validate(function(e){e&&(t.form.id?(t.submitLoading=!0,null==t.form.sortOrder&&(t.form.sortOrder=0),delete t.form.icon,delete t.form.frontComponent,delete t.form.buttonType,delete t.form.updateTime,delete t.form.selected,delete t.form.description,delete t.form.children,delete t.form.children,Object(o.v)(t.form).then(function(e){t.submitLoading=!1,e.success&&(t.$Message.success("编辑成功"),t.$store.commit("setAdded",!1),s.a.initRouter(t),t.init(),t.menuModalVisible=!1)})):t.$Message.warning("请先点击选择要修改的菜单节点"))})},submitAdd:function(){var t=this;this.$refs.formAdd.validate(function(e){e&&(t.submitLoading=!0,Object(o.c)(t.formAdd).then(function(e){t.submitLoading=!1,e.success&&(t.$Message.success("添加成功"),t.$store.commit("setAdded",!1),s.a.initRouter(t),t.init(),t.menuModalVisible=!1)}))})},addMenu:function(){this.form.id?(this.parentTitle=this.form.title,this.modalTitle="添加子节点",this.showParent=!0,2!=this.form.level?(this.formAdd={parentId:this.form.id,level:Number(this.form.level)+1,sortOrder:0,permission:""},0==this.form.level&&(this.formAdd.path="/",this.formAdd.frontRoute="Main"),this.menuModalVisible=!0):this.$Modal.warning({title:"抱歉，不能添加啦",content:"仅支持2级菜单目录"})):this.$Message.warning("请先点击选择一个菜单权限节点")},addRootMenu:function(){this.modalTitle="添加顶级菜单",this.showParent=!1,this.formAdd={level:0,sortOrder:0},this.menuModalVisible=!0},changeSelect:function(e){this.selectCount=e.length,this.selectList=e},delAll:function(){var r=this;this.selectCount<=0?this.$Message.warning("您还未勾选要删除的数据"):this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectCount+" 条数据?",loading:!0,onOk:function(){var t="";r.selectList.forEach(function(e){t+=e.id+","}),t=t.substring(0,t.length-1),Object(o.q)(t).then(function(e){r.$Modal.remove(),e.success&&(r.$Message.success("删除成功"),r.$store.commit("setAdded",!1),s.a.initRouter(r),r.selectList=[],r.selectCount=0,r.cancelEdit(),r.init())})}})}},mounted:function(){var e=document.documentElement.clientHeight;this.maxHeight=Number(e-287)+"px",this.init()}},r=(r("eaec"),r("2877")),r=Object(r.a)(i,function(){var t=this,e=t._self._c;return e("div",{staticClass:"search"},[e("Card",[e("Row",{staticClass:"operation"},[e("i-switch",{staticClass:"selectModel",staticStyle:{"margin-right":"5px"},attrs:{size:"large"},model:{value:t.strict,callback:function(e){t.strict=e},expression:"strict"}},[e("span",{attrs:{slot:"open"},slot:"open"},[t._v("级联")]),e("span",{attrs:{slot:"close"},slot:"close"},[t._v("单选")])]),e("Button",{on:{click:t.addRootMenu}},[t._v("添加顶级菜单")]),e("Button",{attrs:{type:"primary"},on:{click:t.addMenu}},[t._v("添加子菜单")]),e("Button",{on:{click:t.delAll}},[t._v("批量删除")]),e("Dropdown",{on:{"on-click":t.handleDropdown}},[e("Button",[t._v(" 更多操作 "),e("Icon",{attrs:{type:"md-arrow-dropdown"}})],1),e("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[e("DropdownItem",{attrs:{name:"refresh"}},[t._v("刷新")]),e("DropdownItem",{attrs:{name:"expandOne"}},[t._v("收合所有")]),e("DropdownItem",{attrs:{name:"expandTwo"}},[t._v("展开一级")]),e("DropdownItem",{attrs:{name:"expandThree"}},[t._v("展开两级")]),e("DropdownItem",{attrs:{name:"expandAll"}},[t._v("展开所有")])],1)],1)],1),e("Row",{attrs:{type:"flex",justify:"start"}},[e("Col",{attrs:{md:8,lg:8,xl:6}},[e("Alert",{attrs:{"show-icon":""}},[t._v(" 当前选择编辑： "),e("span",{staticClass:"select-title"},[t._v(t._s(t.editTitle))]),t.form.id?e("a",{staticClass:"select-clear",on:{click:t.cancelEdit}},[t._v("取消选择")]):t._e()]),e("Input",{attrs:{suffix:"ios-search",placeholder:"输入菜单名搜索",clearable:""},on:{"on-change":t.search},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),e("div",{staticClass:"tree-bar",style:{maxHeight:t.maxHeight}},[e("Tree",{ref:"tree",attrs:{data:t.data,"show-checkbox":"",render:t.renderContent,"check-strictly":!t.strict},on:{"on-select-change":t.selectTree,"on-check-change":t.changeSelect}}),t.loading?e("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)],1),e("Col",{staticStyle:{"margin-left":"10px"},attrs:{md:15,lg:13,xl:9}},[e("Form",{ref:"form",attrs:{model:t.form,"label-width":110,rules:t.formValidate}},[e("FormItem",{attrs:{label:"类型",prop:"type"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:0==t.form.level,expression:"form.level == 0"}]},[e("Icon",{staticStyle:{"margin-right":"5px"},attrs:{type:"ios-navigate-outline",size:"16"}}),e("span",[t._v("顶级菜单")])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.form.level||2==t.form.level,expression:"form.level == 1 || form.level == 2"}]},[e("Icon",{staticStyle:{"margin-right":"5px"},attrs:{type:"ios-list-box-outline",size:"16"}}),e("span",[t._v("页面菜单")])],1)]),e("FormItem",{attrs:{label:"菜单名称",prop:"title"}},[e("Input",{staticClass:"menu-input",model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),0!=t.form.level?e("FormItem",{staticClass:"block-tool",attrs:{label:"路由地址",prop:"path"}},[e("Tooltip",{attrs:{placement:"right",content:"路由地址，英文唯一，跳转页面，路径展示用 "}},[e("Input",{staticClass:"menu-input",model:{value:t.form.path,callback:function(e){t.$set(t.form,"path",e)},expression:"form.path"}})],1)],1):t._e(),e("FormItem",{staticClass:"block-tool",attrs:{label:"路由名称",prop:"name"}},[e("Tooltip",{attrs:{placement:"right",content:"路由name，需英文唯一，跳转页面用",transfer:""}},[e("Input",{staticClass:"menu-input",model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),0!=t.form.level?e("FormItem",{attrs:{label:"文件路径",prop:"frontRoute"}},[e("Input",{staticClass:"menu-input",model:{value:t.form.frontRoute,callback:function(e){t.$set(t.form,"frontRoute",e)},expression:"form.frontRoute"}})],1):t._e(),0!=t.form.level?e("FormItem",{staticClass:"block-tool",attrs:{label:"权限url"}},[e("Tooltip",{attrs:{placement:"right",content:"*号模糊匹配，逗号分割",transfer:""}},[e("Input",{staticClass:"menu-input",attrs:{type:"textarea"},model:{value:t.form.permission,callback:function(e){t.$set(t.form,"permission",e)},expression:"form.permission"}})],1)],1):t._e(),e("FormItem",{attrs:{label:"排序值",prop:"sortOrder"}},[e("Tooltip",{attrs:{trigger:"hover",placement:"right",content:"值越小越靠前，支持小数"}},[e("InputNumber",{attrs:{max:1e3,min:0},model:{value:t.form.sortOrder,callback:function(e){t.$set(t.form,"sortOrder",e)},expression:"form.sortOrder"}})],1)],1),e("Form-item",[e("Button",{staticStyle:{"margin-right":"5px"},attrs:{loading:t.submitLoading,type:"primary"},on:{click:t.submitEdit}},[t._v("保存 ")]),e("Button",{on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1)],1)],1),e("Modal",{attrs:{draggable:"",title:t.modalTitle,"mask-closable":!1,width:500,styles:{top:"30px"}},model:{value:t.menuModalVisible,callback:function(e){t.menuModalVisible=e},expression:"menuModalVisible"}},[e("Form",{ref:"formAdd",attrs:{model:t.formAdd,"label-width":100,rules:t.formValidate}},[t.showParent?e("div",[e("FormItem",{attrs:{label:"上级节点："}},[t._v(t._s(t.parentTitle))])],1):t._e(),e("FormItem",{attrs:{label:"类型",prop:"type"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:0==t.formAdd.level,expression:"formAdd.level == 0"}]},[e("Icon",{staticStyle:{"margin-right":"5px"},attrs:{type:"ios-navigate-outline",size:"16"}}),e("span",[t._v("顶级菜单")])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:0!=t.formAdd.level,expression:"formAdd.level != 0"}]},[e("Icon",{staticStyle:{"margin-right":"5px"},attrs:{type:"ios-list-box-outline",size:"16"}}),e("span",[t._v("页面菜单")])],1)]),e("FormItem",{attrs:{label:"菜单名称",prop:"title"}},[e("Input",{staticClass:"menu-input",model:{value:t.formAdd.title,callback:function(e){t.$set(t.formAdd,"title",e)},expression:"formAdd.title"}})],1),0!=t.formAdd.level?e("FormItem",{attrs:{label:"路由地址",prop:"path"}},[e("Input",{model:{value:t.formAdd.path,callback:function(e){t.$set(t.formAdd,"path",e)},expression:"formAdd.path"}})],1):t._e(),e("FormItem",{staticClass:"block-tool",attrs:{label:"路由名称",prop:"name"}},[e("Tooltip",{attrs:{placement:"right",content:"路由name，需英文唯一，跳转页面用"}},[e("Input",{model:{value:t.formAdd.name,callback:function(e){t.$set(t.formAdd,"name",e)},expression:"formAdd.name"}})],1)],1),0!=t.formAdd.level?e("FormItem",{attrs:{label:"文件路径",prop:"frontRoute"}},[e("Input",{model:{value:t.formAdd.frontRoute,callback:function(e){t.$set(t.formAdd,"frontRoute",e)},expression:"formAdd.frontRoute"}})],1):t._e(),0!=t.formAdd.level?e("FormItem",{attrs:{label:"权限url"}},[e("Input",{attrs:{type:"textarea"},model:{value:t.formAdd.permission,callback:function(e){t.$set(t.formAdd,"permission",e)},expression:"formAdd.permission"}}),e("div",{staticClass:"desc"},[t._v("*号模糊匹配，逗号分割")])],1):t._e(),e("FormItem",{attrs:{label:"排序值",prop:"sortOrder"}},[e("Tooltip",{attrs:{trigger:"hover",placement:"right",content:"值越小越靠前，支持小数"}},[e("InputNumber",{attrs:{max:1e3,min:0},model:{value:t.formAdd.sortOrder,callback:function(e){t.$set(t.formAdd,"sortOrder",e)},expression:"formAdd.sortOrder"}})],1)],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"text"},on:{click:function(e){t.menuModalVisible=!1}}},[t._v("取消")]),e("Button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.submitAdd}},[t._v("提交")])],1)],1)],1)},[],!1,null,"393f9316",null);t.default=r.exports},"57d5":function(e,t,r){},eaec:function(e,t,r){"use strict";r("57d5")}}]);