(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-174c1370"],{"8f9e":function(e,t,i){"use strict";i.r(t);var o=i("f74c"),r={name:"addSeckill",data:function(){return{form:{promotionName:"",applyEndTime:"",startTime:"",seckillPeriod:[],seckillRule:"",promotionStatus:"NEW"},id:this.$route.query.id,periodTime:null,showAddPeriod:!1,submitLoading:!1,formRule:{promotionName:[{required:!0,message:"请填写活动名称"}],applyEndTime:[{required:!0,message:"请填写报名截止时间"}],seckillPeriod:[{required:!0,message:"请填写抢购时间段"}],startTime:[{required:!0,message:"请填写活动开始时间"}],seckillRule:[{required:!0,message:"请输入申请规则"}]}}},mounted:function(){this.id&&this.getData()},methods:{closeCurrentPage:function(){this.$store.commit("removeTag","manager-seckill-add"),localStorage.pageOpenedList=JSON.stringify(this.$store.state.app.pageOpenedList),this.$router.go(-1)},getData:function(){var i=this;Object(o.H)(this.id).then(function(e){var t;e.success&&((t=e.result).seckillPeriod=e.result.hours.split(","),i.form=t)})},addPeriod:function(){this.addPeriodTime(),this.showAddPeriod=!0},addPeriodTime:function(){this.showAddPeriod=!1,null===this.periodTime||this.form.seckillPeriod.includes(this.periodTime)||this.form.seckillPeriod.push(this.periodTime)},removePeriodTime:function(e,t){this.form.seckillPeriod=this.form.seckillPeriod.filter(function(e){return e!==t})},handleSubmit:function(){var t=this;this.$refs.form.validate(function(e){e&&(t.submitLoading=!0,t.form.hours=t.form.seckillPeriod.toString(),delete t.form.createTime,delete t.form.updateTime,delete t.form.endTime,delete t.form.seckillApplyList,(e=t.form).startTime=t.$options.filters.unixToDate(t.form.startTime/1e3),e.applyEndTime=t.$options.filters.unixToDate(t.form.applyEndTime/1e3),Object(o.O)(e).then(function(e){t.submitLoading=!1,e&&e.success&&(t.$Message.success("编辑成功"),t.closeCurrentPage())}))})}}},i=(i("f28e"),i("2877")),i=Object(i.a)(r,function(){var t=this,i=t._self._c;return i("div",[i("Card",[i("Form",{ref:"form",attrs:{model:t.form,"label-width":120,rules:t.formRule}},[i("div",{staticClass:"base-info-item"},[i("h4",[t._v("基本信息")]),i("div",{staticClass:"form-item-view"},[i("FormItem",{attrs:{label:"活动名称",prop:"promotionName"}},[i("Input",{staticStyle:{width:"260px"},attrs:{type:"text",placeholder:"请填写活动名称",clearable:""},model:{value:t.form.promotionName,callback:function(e){t.$set(t.form,"promotionName",e)},expression:"form.promotionName"}})],1),i("FormItem",{attrs:{label:"报名截止时间",prop:"applyEndTime"}},[i("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"请选择",clearable:""},model:{value:t.form.applyEndTime,callback:function(e){t.$set(t.form,"applyEndTime",e)},expression:"form.applyEndTime"}})],1),i("FormItem",{attrs:{label:"活动开始时间",prop:"startTime"}},[i("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"datetime",format:"yyyy-MM-dd",placeholder:"请选择",clearable:""},model:{value:t.form.startTime,callback:function(e){t.$set(t.form,"startTime",e)},expression:"form.startTime"}})],1),i("FormItem",{attrs:{label:"抢购时间段",prop:"seckillPeriod"}},[t._l(t.form.seckillPeriod,function(e){return i("Tag",{key:e,staticStyle:{"marrgin-left":"10px"},attrs:{name:e,closable:""},on:{"on-close":t.removePeriodTime}},[t._v(t._s(10<=e?e:"0"+e)+":00")])}),i("InputNumber",{directives:[{name:"show",rawName:"v-show",value:t.showAddPeriod,expression:"showAddPeriod"}],attrs:{max:23,min:0},on:{"on-blur":t.addPeriodTime},model:{value:t.periodTime,callback:function(e){t.periodTime=e},expression:"periodTime"}}),i("Button",{attrs:{type:"default"},on:{click:t.addPeriod}},[t._v("添加时间段")])],2),i("FormItem",{attrs:{label:"申请规则",prop:"seckillRule"}},[i("Input",{staticStyle:{width:"260px"},attrs:{type:"text",placeholder:"申请规则",clearable:""},model:{value:t.form.seckillRule,callback:function(e){t.$set(t.form,"seckillRule",e)},expression:"form.seckillRule"}})],1)],1),i("div",{staticClass:"foot-btn"},[i("Button",{staticStyle:{"margin-right":"5px"},on:{click:t.closeCurrentPage}},[t._v("返回")]),i("Button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.handleSubmit}},[t._v("提交")])],1)])])],1)],1)},[],!1,null,"533f99fd",null);t.default=i.exports},b518:function(e,t,i){},f28e:function(e,t,i){"use strict";i("b518")}}]);